<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Maximum a Posteriori · HMMBase</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="HMMBase logo"/></a><div class="docs-package-name"><span class="docs-autofit">HMMBase</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../basics/">Basics</a></li><li><a class="tocitem" href="../../models/">Model</a></li><li><a class="tocitem" href="../../algorithms/">Algorithms</a></li><li><a class="tocitem" href="../../utilities/">Utilities</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../basic_usage/">Basic Usage</a></li><li class="is-active"><a class="tocitem" href>Maximum a Posteriori</a></li><li><a class="tocitem" href="../numerical_stability/">Numerical Stability</a></li></ul></li><li><a class="tocitem" href="../../internals/">Internals</a></li><li><a class="tocitem" href="../../migration/">Migrating to v1.0</a></li><li><a class="tocitem" href="../../_index/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Maximum a Posteriori</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Maximum a Posteriori</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/maxmouchet/HMMBase.jl/blob/master/examples/fit_map.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Maximum-a-Posteriori-1"><a class="docs-heading-anchor" href="#Maximum-a-Posteriori-1">Maximum a Posteriori</a><a class="docs-heading-anchor-permalink" href="#Maximum-a-Posteriori-1" title="Permalink"></a></h1><pre><code class="language-julia">using Distributions
using HMMBase
using PyPlot
using Seaborn</code></pre><p>Let&#39;s consider a simple time series with one outlier:</p><pre><code class="language-julia">y = rand(1000)
y[100] = 10000
plot(y)</code></pre><img src="data:image/png;base64,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ihXq3r27x/qEhASFh4d71MrBgwdVXl6ulJQUSVJKSor27dvn8Uc6Pz9fbdq0UXR0dPPsCJrcb37zG23YsEHr1q0zvxISEjRkyBBzmlpBvd69e5vXf9f76quv1LVrV0lSt27d5HA4POqlpqZGX3zxhfl/KDU1VdXV1SouLjbbbN26VW63W0lJSc2wF2gup06dUkhIiMcym81m3lqUekFTs2VmZmYGuhPNrU2bNlq8eLE6d+6siIgILV68WCUlJXr22Wd11VVXBbp7aCYzZ87Uhg0btGTJEnXs2FG1tbWqra2VzWZTWFiYWrVqpW+//dqU5+MAAAITSURBVFarV69WXFycjh07phkzZqhz587mLSO7d++uf//738rPz1dsbKxKSko0e/ZsDR8+XE6nM8B7CH+JiIhQVFSUx9c777yjbt26KT09nVqBh86dO2vp0qWy2WxyOBzasmWLXnjhBU2YMEGxsbEKCQlRXV2dli9frp49e+rs2bOaM2eOTp06pWeeeUZhYWHq0KGDvvjiC23cuFHx8fE6cuSIZsyYIafTqaFDhwZ6F+FHBw4c0Ntvv60ePXooLCxMn376qRYuXKi7775bt956K/WCJhdiGA2eamEhr732ml5++WVVVFSoV69emjZtmpKTkwPdLTSjn94nvl5WVpb5x/P06dOaN2+eNm7cqDNnzsjpdGrGjBkep12//vprZWZmatu2bYqMjFR6eromT56ssDCG5ASzkSNHKi4uTk8//bQkagWePvzwQy1cuFBfffWVunXrptGjR+uBBx4w1xuGoSVLlmjNmjWqrq7WTTfdpBkzZqhHjx5mm2PHjmn27Nn64IMPFBoaqkGDBmnatGm6+uqrA7FLaCI1NTVavHixNm/erKqqKnXs2FGDBw/WY489poiICEnUC5qWZcMAAAAAYHWWGzMAAAAA4BzCAAAAAGBRhAEAAADAoggDAAAAgEURBgAAAACLIgwAAAAAFkUYAAAAACyKMAAAAABYFGEAAAAAsCjCAAAAAGBRhAEAAADAov4/KbNdpiyvPX0AAAAASUVORK5CYII=" /><p>An MLE approach to observations distributions parameters may fail with a singularity (variance = 0) if an outlier becomes the only observation associated to some state:</p><pre><code class="language-julia">hmm = HMM([0.9 0.1; 0.1 0.9], [Normal(0,1), Normal(5,1)])
try
    fit_mle(hmm, y, display=:iter);
catch e
    println(e)
end</code></pre><pre><code class="language-none">Iteration 0: logtot = -1230.6657301979515
Iteration 1: logtot = -186.8339402902164
Iteration 2: logtot = -11.713017504274575
Iteration 3: logtot = NaN
ArgCheck.CheckError(&quot;isprobvec(hmm.a) must hold. Got\nhmm.a =&gt; [NaN, NaN]&quot;)</code></pre><p>We can avoid this by putting a prior on the variance:</p><pre><code class="language-julia">import ConjugatePriors: InverseGamma, NormalKnownMu, posterior_canon
import StatsBase: Weights

function fit_map(::Type{&lt;:Normal}, observations, responsibilities)
    μ = mean(observations, Weights(responsibilities))

    ss = suffstats(NormalKnownMu(μ), observations, responsibilities)
    prior = InverseGamma(2,1)
    posterior = posterior_canon(prior, ss)
    σ2 = mode(posterior)

    Normal(μ, sqrt(σ2))
end

hmm, _ = fit_mle(hmm, y, estimator=fit_map, display=:iter);
hmm.B</code></pre><pre><code class="language-none">2-element Array{Distribution{Univariate,S} where S&lt;:ValueSupport,1}:
 Normal{Float64}(μ=0.5002249742142206, σ=0.29004634497715975)
 Normal{Float64}(μ=10000.0, σ=0.5345224838248488)            </code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../basic_usage/">« Basic Usage</a><a class="docs-footer-nextpage" href="../numerical_stability/">Numerical Stability »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 26 February 2020 17:04">Wednesday 26 February 2020</span>. Using Julia version 1.2.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
